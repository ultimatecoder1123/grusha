<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>–ì—Ä—É—à–∞</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script>
        const LOGO_URL = "https://pngicon.ru/file/uploads/grusha.png";
    </script>
    <style>
        body {
            background: linear-gradient(45deg, #83E8BA, #FFE27D);
            user-select: none;
            overflow-x: hidden;
            margin: 0;
            padding-bottom: 50px;
            animation: fadeIn 1s ease-in;
        }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        .score-board {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            padding: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            margin-bottom: 20px;
            display: flex;
            flex-wrap: wrap;
            align-items: center;
            gap: 10px;
        }
        .score-board h1, .score-board p {
            margin: 0;
        }
        .score-board h1 img.logo {
            height: 30px;
            vertical-align: middle;
            margin-right: 10px;
        }
        .auth-btn {
            padding: 10px 20px;
            background: linear-gradient(45deg, #83E8BA, #FFE27D);
            border: none;
            border-radius: 5px;
            font-size: 16px;
            cursor: pointer;
            transition: transform 0.2s;
            margin: 5px;
        }
        .auth-btn:hover { transform: scale(1.05); }
        .auth-btn:active { transform: scale(0.95); }
        .pear-btn {
            font-size: 150px;
            cursor: pointer;
            transition: transform 0.5s ease-in-out;
            animation: float 3s ease-in-out infinite;
            filter: drop-shadow(0 10px 5px rgba(0,0,0,0.2));
            outline: none;
            display: inline-block;
        }
        .pear-btn:active { transform: scale(0.9); }
        @keyframes float {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-20px); }
            100% { transform: translateY(0px); }
        }
        .shop-item {
            background: white;
            padding: 15px;
            border-radius: 10px;
            margin: 10px 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: transform 0.2s;
        }
        .shop-item:hover { transform: translateX(10px); }
        .powerups {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
            margin: 20px 0;
        }
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            justify-content: center;
            align-items: center;
        }
        .modal-content {
            background: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            min-width: 300px;
            position: relative;
        }
        .close {
            position: absolute;
            top: 10px;
            right: 15px;
            font-size: 24px;
            cursor: pointer;
            color: #333;
            transition: color 0.2s;
        }
        .close:hover { color: #ff0000; }
        .hidden { display: none; }
        .auth-container {
            padding: 20px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        .auth-input {
            padding: 10px;
            margin: 10px 0;
            border: 2px solid #83E8BA;
            border-radius: 5px;
            font-size: 16px;
            width: 80%;
        }
        .code-display {
            font-size: 18px;
            padding: 10px;
            background: #f0f0f0;
            border-radius: 5px;
            margin: 10px 0;
            word-wrap: break-word;
            user-select: text;
        }
        .footer-text {
            text-align: center;
            font-size: 14px;
            color: #333;
            padding: 10px;
            position: fixed;
            bottom: 0;
            width: 100%;
            background: rgba(255, 255, 255, 0.7);
        }
        .pear-fall {
            position: absolute;
            font-size: 30px;
            z-index: 500;
            animation: fall 2s linear forwards;
        }
        @keyframes fall {
            from { top: -50px; opacity: 1; }
            to { top: 100%; opacity: 0; }
        }
        .achievements {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            padding: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            margin: 20px 0;
        }
        .achievement-item {
            margin: 5px 0;
            padding: 5px;
            background: #83E8BA;
            border-radius: 5px;
        }
        .warning-text {
            color: #ff4444;
            font-size: 14px;
            margin: 10px 0;
        }
        #pest {
            position: fixed;
            font-size: 50px;
            z-index: 500;
            animation: run 5s linear forwards;
            top: 40px;
        }
        @keyframes run {
            0% { left: -10%; }
            100% { left: 110%; }
        }
        @media (max-width: 600px) {
            .pear-btn { font-size: 100px; }
            .container { padding: 10px; }
            .score-board { padding: 10px; }
            .shop-item { padding: 10px; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="score-board">
            <h1>
                <img src="" alt="–õ–æ–≥–æ—Ç–∏–ø" class="logo" id="logo">
                –ì—Ä—É—à: <span id="score">0</span>
            </h1>
            <p>üöÄ –ê–≤—Ç–æ–≥—Ä—É—à/—Å–µ–∫: <span id="autoClickers">0</span></p>
            <button class="auth-btn" onclick="showAuthModal()">–ê–∫–∫–∞—É–Ω—Ç</button>
            <span id="userStatus"></span>
        </div>
        <div class="text-center" style="text-align:center;">
            <div id="pear" class="pear-btn">üçê</div>
            <p>–ö–ª–∏–∫–∞–π –±—ã—Å—Ç—Ä–µ–µ!</p>
        </div>
        <div class="powerups">
            <div class="shop-item" onclick="buyAutoClicker()">
                <div>
                    <h3>ü§ñ –ê–≤—Ç–æ–≥—Ä—É—à</h3>
                    <p>–¶–µ–Ω–∞: <span id="autoClickerCost">50</span> üçê</p>
                </div>
                <span id="autoClickerCount">0</span>
            </div>
            <div class="shop-item" onclick="buyMultiplier()">
                <div>
                    <h3>‚ö° –°–æ–∫–æ–≤—ã–∂–∏–º–∞–ª–∫–∞ (30 —Å–µ–∫)</h3>
                    <p>–¶–µ–Ω–∞: <span id="multiplierCost">200</span> üçê</p>
                </div>
                <span id="multiplierCount">0</span>
            </div>
            <div class="shop-item" onclick="removePest()">
                <div>
                    <h3>üõ° –£–±–∏—Ç—å –≤—Ä–µ–¥–∏—Ç–µ–ª—è</h3>
                    <p>–¶–µ–Ω–∞: 5000 üçê</p>
                </div>
            </div>
            <div id="finishGameBtn" class="shop-item hidden" onclick="finishGame()">
                <div>
                    <h3>üèÅ –ó–∞–∫–æ–Ω—á–∏—Ç—å –∏–≥—Ä—É</h3>
                    <p>–¶–µ–Ω–∞: 1,000,000,000 üçê</p>
                </div>
            </div>
        </div>
        <div class="achievements">
            <h2>–î–æ—Å—Ç–∏–∂–µ–Ω–∏—è</h2>
            <div id="achievementList"></div>
        </div>
    </div>
    <div id="modal" class="modal">
        <div class="modal-content">
            <div id="modalBody"></div>
        </div>
    </div>
    <div class="footer-text">–í–µ—Å—å –ø—Ä–æ–≥—Ä–µ—Å—Å —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ –±—Ä–∞—É–∑–µ—Ä–µ, –Ω–µ –ø–æ—Ç–µ—Ä—è–π—Ç–µ –µ–≥–æ</div>

    <script>
        let score = 0, autoClickers = 0, autoClickerCost = 50, multiplierActive = false;
        let clickTimes = [], clickIntervals = [], isCaptchaActive = false;
        let currentUser = null, pestActive = false, pestSlayerAchieved = false;
        let pestElem = null;

        const modal = document.getElementById('modal'),
              modalBody = document.getElementById('modalBody'),
              achievementList = document.getElementById('achievementList'),
              pearElem = document.getElementById('pear'),
              logoElem = document.getElementById('logo');

        logoElem.src = LOGO_URL;

        const bannedNames = ["ultimate coder"];
        const bannedWords = ["fuck", "shit", "bitch", "—Ö—É–π", "–ø–∏–∑–¥–∞", "—Å—É–∫–∞"];

        const achievements = [
            { id: 'first100', name: '–ù–æ–≤–∏—á–æ–∫ ü•≥', condition: () => score >= 100, completed: false },
            { id: 'auto10', name: '–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ç–æ—Ä ü§ñ', condition: () => autoClickers >= 10, completed: false },
            { id: 'score1000', name: '–ì—Ä—É—à–µ–≤—ã–π –º–∞—Å—Ç–µ—Ä üçê', condition: () => score >= 1000, completed: false },
            { id: 'multiplier', name: '–°–æ–∫–æ–≤—ã–∂–∏–º–∞—Ç–µ–ª—å ‚ö°', condition: () => multiplierActive, completed: false },
            { id: 'pestSlayer', name: '–£–±–∏–π—Ü–∞ –≤—Ä–µ–¥–∏—Ç–µ–ª–µ–π üêõ', condition: () => pestSlayerAchieved, completed: false }
        ];

        function updateUserStatus() {
            const userStatus = document.getElementById('userStatus');
            userStatus.textContent = currentUser ? "–í—ã –≤–æ—à–ª–∏ –∫–∞–∫: " + currentUser : "";
        }

        function saveProgress() {
            if (currentUser) {
                const progress = { 
                    score, 
                    autoClickers, 
                    autoClickerCost, 
                    multiplierActive, 
                    achievements: achievements.map(a => a.completed)
                };
                let accountDataStr = localStorage.getItem('gameAccount_' + currentUser);
                if (accountDataStr) {
                    let accountData = JSON.parse(accountDataStr);
                    accountData.progress = progress;
                    localStorage.setItem('gameAccount_' + currentUser, JSON.stringify(accountData));
                }
            }
        }

        function updateDisplay() {
            document.getElementById('score').textContent = currentUser === "creatorucgame" ? "‚àû" : Math.floor(score);
            document.getElementById('autoClickers').textContent = currentUser === "creatorucgame" ? "‚àû" : autoClickers;
            document.getElementById('autoClickerCost').textContent = autoClickerCost;
            document.getElementById('autoClickerCount').textContent = currentUser === "creatorucgame" ? "‚àû" : autoClickers;
            if (score >= 100 || currentUser === "creatorucgame") document.getElementById('finishGameBtn').classList.remove('hidden');
            checkAchievements();
            updateUserStatus();
            if(currentUser && currentUser !== "creatorucgame") saveProgress();
        }

        function clickPear(event) {
            if (isCaptchaActive) return;
            const now = Date.now();
            clickTimes.push(now);
            if (clickTimes.length > 1)
                clickIntervals.push(clickTimes[clickTimes.length - 1] - clickTimes[clickTimes.length - 2]);
            clickTimes = clickTimes.filter(time => now - time < 20000);
            clickIntervals = clickIntervals.filter((_, i) => i >= clickIntervals.length - 40);
            
            if (currentUser !== "creatorucgame") {
                score += multiplierActive ? 2 : 1;
            }
            updateDisplay();
            if (clickTimes.length > 200) showCaptcha("–°–ª–∏—à–∫–æ–º –±—ã—Å—Ç—Ä–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å –∫–ª–∏–∫–æ–≤!");
            if (checkConsistentIntervals()) showCaptcha("–û–±–Ω–∞—Ä—É–∂–µ–Ω—ã –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ —Ä–æ–≤–Ω—ã–µ –∫–ª–∏–∫–∏!");
        }

        function checkConsistentIntervals() {
            if (clickIntervals.length < 40) return false;
            const avg = clickIntervals.reduce((a, b) => a + b, 0) / clickIntervals.length;
            return clickIntervals.every(i => Math.abs(i - avg) < 10) &&
                   (clickTimes[clickTimes.length - 1] - clickTimes[0] >= 20000);
        }

        function buyAutoClicker() {
            if (currentUser === "creatorucgame") return; // –ù–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞–µ–º, —É–∂–µ –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ
            if (score >= autoClickerCost) {
                score -= autoClickerCost;
                autoClickers++;
                autoClickerCost = Math.floor(autoClickerCost * 1.15);
                updateDisplay();
            }
        }

        function buyMultiplier() {
            if (currentUser === "creatorucgame") return; // –ù–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞–µ–º
            if (score >= 200 && !multiplierActive) {
                score -= 200;
                multiplierActive = true;
                setTimeout(() => { multiplierActive = false; updateDisplay(); }, 30000);
                updateDisplay();
            }
        }

        function removePest() {
            if (!pestActive) {
                alert("–ù–µ—Ç –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –≤—Ä–µ–¥–∏—Ç–µ–ª—è!");
                return;
            }
            if (currentUser === "creatorucgame" || score >= 5000) {
                if (currentUser !== "creatorucgame") score -= 5000;
                pestActive = false;
                removePestElement();
                pestSlayerAchieved = true;
                updateDisplay();
                checkAchievements();
                alert("–í—Ä–µ–¥–∏—Ç–µ–ª—å —É–Ω–∏—á—Ç–æ–∂—ë–Ω!");
            } else {
                alert("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –≥—Ä—É—à –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –≤—Ä–µ–¥–∏—Ç–µ–ª—è!");
            }
        }

        function finishGame() {
            const finishCost = 1000000000;
            if (currentUser === "creatorucgame" || score >= finishCost) { 
                if (currentUser !== "creatorucgame") score -= finishCost; 
                updateDisplay(); 
                window.location.href = "https://sites.google.com/view/grushauc/finish1"; 
            } else {
                alert("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –≥—Ä—É—à –¥–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∏–≥—Ä—ã!");
            }
        }

        function showCaptcha(message) {
            isCaptchaActive = true;
            modalBody.innerHTML = `
                <div class="auth-container">
                    <h2>–ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Ä–æ–±–æ—Ç–∞</h2>
                    <p>${message}</p>
                    <button class="auth-btn" onclick="showMathCaptcha()">–Ø –Ω–µ —Ä–æ–±–æ—Ç</button>
                </div>`;
            modal.style.display = 'flex';
        }

        function showMathCaptcha() {
            const num1 = Math.floor(Math.random() * 10) + 1,
                  num2 = Math.floor(Math.random() * 10) + 1,
                  correct = num1 + num2;
            modalBody.innerHTML = `
                <div class="auth-container">
                    <h2>–ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Ä–æ–±–æ—Ç–∞</h2>
                    <p>–†–µ—à–∏—Ç–µ –ø—Ä–∏–º–µ—Ä: ${num1} + ${num2} = ?</p>
                    <input type="text" id="captcha-answer" class="auth-input" placeholder="–í–∞—à –æ—Ç–≤–µ—Ç">
                    <button class="auth-btn" onclick="checkCaptcha(${correct})">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å</button>
                </div>`;
        }

        function checkCaptcha(correct) {
            if (parseInt(document.getElementById('captcha-answer').value) === correct) {
                isCaptchaActive = false;
                clickTimes = [];
                clickIntervals = [];
                modal.style.display = 'none';
            } else {
                alert("–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑.");
            }
        }

        function showAuthModal() {
            if(currentUser) {
                modalBody.innerHTML = `
                    <span class="close" onclick="closeModal()">√ó</span>
                    <div class="auth-container">
                        <h2>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –∞–∫–∫–∞—É–Ω—Ç–µ</h2>
                        <p>–í—ã –≤–æ—à–ª–∏ –∫–∞–∫: ${currentUser}</p>
                        <button class="auth-btn" onclick="logoutUser()">–í—ã–π—Ç–∏</button>
                        <button class="auth-btn" onclick="closeModal()">–ó–∞–∫—Ä—ã—Ç—å</button>
                    </div>`;
            } else {
                modalBody.innerHTML = `
                    <span class="close" onclick="closeModal()">√ó</span>
                    <div class="auth-container">
                        <h2>–í–æ–π—Ç–∏ –∏–ª–∏ –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</h2>
                        <div>
                            <button class="auth-btn" onclick="showLoginForm()">–í–æ–π—Ç–∏</button>
                            <button class="auth-btn" onclick="showRegisterForm()">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>
                        </div>
                        <div id="authFormContainer"></div>
                    </div>`;
            }
            modal.style.display = 'flex';
        }

        function showLoginForm() {
            document.getElementById('authFormContainer').innerHTML = `
                <input type="text" id="login-username" class="auth-input" placeholder="–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è">
                <input type="password" id="login-password" class="auth-input" placeholder="–ü–∞—Ä–æ–ª—å">
                <button class="auth-btn" onclick="processLogin()">–í–æ–π—Ç–∏</button>
            `;
        }

        function showRegisterForm() {
            document.getElementById('authFormContainer').innerHTML = `
                <input type="text" id="register-username" class="auth-input" placeholder="–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è">
                <input type="password" id="register-password" class="auth-input" placeholder="–ü–∞—Ä–æ–ª—å">
                <input type="password" id="register-password-confirm" class="auth-input" placeholder="–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å">
                <button class="auth-btn" onclick="processRegistration()">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
            `;
        }

        function processRegistration() {
            const username = document.getElementById('register-username').value.trim();
            const password = document.getElementById('register-password').value;
            const passwordConfirm = document.getElementById('register-password-confirm').value;
            if(!username || !password) {
                alert("–í–≤–µ–¥–∏—Ç–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –ø–∞—Ä–æ–ª—å!");
                return;
            }
            if(bannedNames.includes(username.toLowerCase())) {
                alert("–≠—Ç–æ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–µ–¥–æ–ø—É—Å—Ç–∏–º–æ!");
                return;
            }
            for (let word of bannedWords) {
                if (username.toLowerCase().includes(word)) {
                    alert("–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω–µ–¥–æ–ø—É—Å—Ç–∏–º—ã–µ —Å–ª–æ–≤–∞!");
                    return;
                }
            }
            if(password !== passwordConfirm) {
                alert("–ü–∞—Ä–æ–ª–∏ –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç!");
                return;
            }
            if(localStorage.getItem('gameAccount_' + username)) {
                alert("–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å —Ç–∞–∫–∏–º –∏–º–µ–Ω–µ–º —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç!");
                return;
            }
            const initialProgress = {
                score: 0,
                autoClickers: 0,
                autoClickerCost: 50,
                multiplierActive: false,
                achievements: achievements.map(a => false)
            };
            const accountData = { username, password, progress: initialProgress };
            localStorage.setItem('gameAccount_' + username, JSON.stringify(accountData));
            currentUser = username;
            localStorage.setItem('gameCurrentUser', username);
            alert("–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞! –í—ã –≤–æ—à–ª–∏ –∫–∞–∫ " + username);
            closeModal();
            updateUserStatus();
        }

        function processLogin() {
            const username = document.getElementById('login-username').value.trim();
            const password = document.getElementById('login-password').value;
            if(!username || !password) {
                alert("–í–≤–µ–¥–∏—Ç–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –ø–∞—Ä–æ–ª—å!");
                return;
            }
            let accountDataStr = localStorage.getItem('gameAccount_' + username);
            if(!accountDataStr) {
                alert("–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω!");
                return;
            }
            let accountData = JSON.parse(accountDataStr);
            if(accountData.password !== password) {
                alert("–ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å!");
                return;
            }
            currentUser = username;
            localStorage.setItem('gameCurrentUser', username);

            if (username === "creatorucgame" && password === "123") {
                score = Infinity;
                autoClickers = Infinity;
                achievements.forEach(a => a.completed = true);
            } else {
                const progress = accountData.progress;
                score = progress.score;
                autoClickers = progress.autoClickers;
                autoClickerCost = progress.autoClickerCost;
                multiplierActive = progress.multiplierActive;
                achievements.forEach((a, index) => a.completed = progress.achievements[index]);
            }
            updateDisplay();
            updateAchievementsDisplay();
            alert("–í—Ö–æ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω —É—Å–ø–µ—à–Ω–æ! –ü—Ä–∏–≤–µ—Ç, " + username);
            closeModal();
            updateUserStatus();
        }

        function logoutUser() {
            currentUser = null;
            localStorage.removeItem('gameCurrentUser');
            alert("–í—ã –≤—ã—à–ª–∏ –∏–∑ –∞–∫–∫–∞—É–Ω—Ç–∞.");
            closeModal();
            updateUserStatus();
        }

        function closeModal() { modal.style.display = 'none'; }

        function checkAchievements() {
            achievements.forEach(a => { 
                if (!a.completed && a.condition()) { 
                    a.completed = true; 
                    spawnFallingPears(); 
                } 
            });
            updateAchievementsDisplay();
        }

        function spawnFallingPears() {
            for (let i = 1; i < 15; i++) {
                const pear = document.createElement('div');
                pear.className = 'pear-fall';
                pear.textContent = 'üçê';
                pear.style.left = `${Math.random() * 100}%`;
                document.body.appendChild(pear);
                setTimeout(() => pear.remove(), 2000);
            }
        }

        function updateAchievementsDisplay() {
            achievementList.innerHTML = '';
            achievements.forEach(a => {
                if (a.completed) {
                    const div = document.createElement('div');
                    div.className = 'achievement-item';
                    div.textContent = a.name;
                    achievementList.appendChild(div);
                }
            });
        }
        

        function spawnPest() {
            if (pestActive || currentUser === "creatorucgame") return; // –í—Ä–µ–¥–∏—Ç–µ–ª—å –Ω–µ –ø–æ—è–≤–ª—è–µ—Ç—Å—è –¥–ª—è creatorucgame
            pestActive = true;
            pestElem = document.createElement('div');
            pestElem.id = 'pest';
            pestElem.textContent = 'üêõ';
            document.body.appendChild(pestElem);

            let pestInterval = setInterval(() => {
                if (!pestActive || !pestElem) {
                    clearInterval(pestInterval);
                    return;
                }
                const pestRect = pestElem.getBoundingClientRect();
                const scoreRect = document.getElementById('score').getBoundingClientRect();
                if (pestRect.left + pestRect.width >= scoreRect.left && 
                    pestRect.left <= scoreRect.right && 
                    !pestElem.dataset.stolen) {
                    const stolen = Math.floor(Math.random() * 15) + 1;
                    score = Math.max(0, score - stolen);
                    updateDisplay();
                    pestElem.dataset.stolen = true;
                }
            }, 100);

            pestElem.addEventListener('animationend', () => {
                pestActive = false;
                clearInterval(pestInterval);
                removePestElement();
                scheduleNextPest();
            });
        }

        function removePestElement() {
            if (pestElem) pestElem.remove();
            pestElem = null;
        }

        function scheduleNextPest() {
            const nextTime = Math.floor(Math.random() * 20000) + 10000;
            setTimeout(spawnPest, nextTime);
        }

        function autoLogin() {
            const savedUser = localStorage.getItem('gameCurrentUser');
            if (savedUser) {
                currentUser = savedUser;
                let accountDataStr = localStorage.getItem('gameAccount_' + currentUser);
                if (accountDataStr) {
                    let accountData = JSON.parse(accountDataStr);
                    if (currentUser === "creatorucgame" && accountData.password === "123") {
                        score = Infinity;
                        autoClickers = Infinity;
                        achievements.forEach(a => a.completed = true);
                    } else {
                        const progress = accountData.progress;
                        score = progress.score;
                        autoClickers = progress.autoClickers;
                        autoClickerCost = progress.autoClickerCost;
                        multiplierActive = progress.multiplierActive;
                        achievements.forEach((a, index) => a.completed = progress.achievements[index]);
                    }
                }
                updateDisplay();
                updateAchievementsDisplay();
                updateUserStatus();
            }
        }

        setInterval(() => { 
            if (currentUser !== "creatorucgame") score += autoClickers; 
            updateDisplay(); 
        }, 1000);
        scheduleNextPest();
        pearElem.addEventListener('click', clickPear);
        updateDisplay();
        updateAchievementsDisplay();
        autoLogin();
    </script>
</body>
</html>
