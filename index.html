<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>–ì—Ä—É—à–∞</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body {
            background: linear-gradient(45deg, #83E8BA, #FFE27D);
            font-family: 'Comic Sans MS', cursive;
            user-select: none;
            overflow-x: hidden;
            margin: 0;
            padding-bottom: 50px;
            animation: fadeIn 1s ease-in;
        }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        .container { max-width: 800px; margin: 0 auto; padding: 20px; }
        .score-board { background: rgba(255, 255, 255, 0.9); border-radius: 15px; padding: 15px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); margin-bottom: 20px; }
        .pear-btn { font-size: 150px; cursor: pointer; transition: transform 0.1s; animation: float 3s ease-in-out infinite; filter: drop-shadow(0 10px 5px rgba(0,0,0,0.2)); }
        .pear-btn:active { transform: scale(0.9); }
        .shop-item { background: white; padding: 15px; border-radius: 10px; margin: 10px 0; display: flex; justify-content: space-between; align-items: center; transition: transform 0.2s; }
        .shop-item:hover { transform: translateX(10px); }
        .powerups { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 10px; margin: 20px 0; }
        .modal { display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.5); justify-content: center; align-items: center; }
        .modal-content { background: white; padding: 20px; border-radius: 10px; text-align: center; min-width: 300px; position: relative; }
        .close { position: absolute; top: 10px; right: 15px; font-size: 24px; cursor: pointer; color: #333; transition: color 0.2s; }
        .close:hover { color: #ff0000; }
        .hidden { display: none; }
        .auth-container { padding: 20px; background: rgba(255, 255, 255, 0.9); border-radius: 15px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
        .auth-btn { padding: 10px 20px; background: linear-gradient(45deg, #83E8BA, #FFE27D); border: none; border-radius: 5px; font-size: 16px; font-family: 'Comic Sans MS', cursive; cursor: pointer; transition: transform 0.2s; margin: 5px; }
        .auth-btn:hover { transform: scale(1.05); }
        .auth-btn:active { transform: scale(0.95); }
        .auth-input { padding: 10px; margin: 10px 0; border: 2px solid #83E8BA; border-radius: 5px; font-size: 16px; font-family: 'Comic Sans MS', cursive; width: 80%; }
        .code-display { font-size: 18px; padding: 10px; background: #f0f0f0; border-radius: 5px; margin: 10px 0; word-wrap: break-word; user-select: text; }
        .footer-text { text-align: center; font-size: 14px; color: #333; padding: 10px; position: fixed; bottom: 0; width: 100%; background: rgba(255, 255, 255, 0.7); }
        .pear-fall { position: absolute; font-size: 30px; z-index: 500; animation: fall 2s linear forwards; }
        @keyframes fall { from { top: -50px; opacity: 1; } to { top: 100%; opacity: 0; } }
        .achievements { background: rgba(255, 255, 255, 0.9); border-radius: 15px; padding: 15px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); margin: 20px 0; }
        .achievement-item { margin: 5px 0; padding: 5px; background: #83E8BA; border-radius: 5px; }
        .warning-text { color: #ff4444; font-size: 14px; margin: 10px 0; }
        @media (max-width: 600px) { .pear-btn { font-size: 100px; } .container { padding: 10px; } .score-board { padding: 10px; } .shop-item { padding: 10px; } }
    </style>
</head>
<body>
    <div class="container">
        <div class="score-board">
            <h1>üçê –ì—Ä—É—à: <span id="score">0</span></h1>
            <p>üöÄ –ê–≤—Ç–æ–≥—Ä—É—à/—Å–µ–∫: <span id="autoClickers">0</span></p>
            <button class="auth-btn" onclick="showAuthModal()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å/–ó–∞–≥—Ä—É–∑–∏—Ç—å</button>
        </div>
        <div class="text-center">
            <div id="pear" class="pear-btn">üçê</div>
            <p>–ö–ª–∏–∫–∞–π –±—ã—Å—Ç—Ä–µ–µ!</p>
        </div>
        <div class="powerups">
            <div class="shop-item" onclick="buyAutoClicker()">
                <div><h3>ü§ñ –ê–≤—Ç–æ–≥—Ä—É—à</h3><p>–¶–µ–Ω–∞: <span id="autoClickerCost">50</span> üçê</p></div>
                <span id="autoClickerCount">0</span>
            </div>
            <div class="shop-item" onclick="buyMultiplier()">
                <div><h3>‚ö° –°–æ–∫–æ–≤—ã–∂–∏–º–∞–ª–∫–∞ (30—Å–µ–∫)</h3><p>–¶–µ–Ω–∞: <span id="multiplierCost">200</span> üçê</p></div>
                <span id="multiplierCount">0</span>
            </div>
            <div id="finishGameBtn" class="shop-item hidden" onclick="finishGame()">
                <div><h3>üèÅ –ó–∞–∫–æ–Ω—á–∏—Ç—å –∏–≥—Ä—É</h3><p>–¶–µ–Ω–∞: 1,000,000,000 üçê</p></div>
            </div>
        </div>
        <div class="achievements">
            <h2>–î–æ—Å—Ç–∏–∂–µ–Ω–∏—è</h2>
            <div id="achievementList"></div>
        </div>
    </div>
    <div id="modal" class="modal">
        <div class="modal-content">
            <div id="modalBody"></div>
        </div>
    </div>
    <div class="footer-text">–ü–µ—Ä–µ–¥ —É—Ö–æ–¥–æ–º –Ω–µ –∑–∞–±—É–¥—å—Ç–µ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å</div>

    <script>
        let score = 0, autoClickers = 0, autoClickerCost = 50, multiplierActive = false, multiplierCost = 200;
        let clickTimes = [], clickIntervals = [], isCaptchaActive = false;
        const modal = document.getElementById('modal'), modalBody = document.getElementById('modalBody');
        const achievementList = document.getElementById('achievementList');

        const achievements = [
            { id: 'first100', name: '–ù–æ–≤–∏—á–æ–∫ ü•≥', condition: () => score >= 100, completed: false },
            { id: 'auto10', name: '–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ç–æ—Ä ü§ñ', condition: () => autoClickers >= 10, completed: false },
            { id: 'score1000', name: '–ì—Ä—É—à–µ–≤—ã–π –º–∞—Å—Ç–µ—Ä üçê', condition: () => score >= 1000, completed: false },
            { id: 'multiplier', name: '–°–æ–∫–æ–≤—ã–∂–∏–º–∞—Ç–µ–ª—å ‚ö°', condition: () => multiplierActive, completed: false }
        ];

        function encryptData() {
            const completed = achievements.map(a => a.completed ? '1' : '0').join('');
            const data = [score, autoClickers, autoClickerCost, completed];
            const json = JSON.stringify(data);
            let result = '';
            for (let i = 0; i < json.length; i++) result += String.fromCharCode(json.charCodeAt(i) + 3);
            return btoa(result);
        }

        function decryptData(encoded) {
            try {
                const decoded = atob(encoded);
                let result = '';
                for (let i = 0; i < decoded.length; i++) result += String.fromCharCode(decoded.charCodeAt(i) - 3);
                return JSON.parse(result);
            } catch (e) { return null; }
        }

        function updateDisplay() {
            document.getElementById('score').textContent = Math.floor(score);
            document.getElementById('autoClickers').textContent = autoClickers;
            document.getElementById('autoClickerCost').textContent = autoClickerCost;
            document.getElementById('autoClickerCount').textContent = autoClickers;
            if (score >= 100) document.getElementById('finishGameBtn').classList.remove('hidden');
            checkAchievements(); // –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ —Å checkAchievement –Ω–∞ checkAchievements
        }

        function clickPear(event) {
            if (isCaptchaActive) return;
            const now = Date.now();
            clickTimes.push(now);
            if (clickTimes.length > 1) clickIntervals.push(clickTimes[clickTimes.length - 1] - clickTimes[clickTimes.length - 2]);
            clickTimes = clickTimes.filter(time => now - time < 20000);
            clickIntervals = clickIntervals.filter((_, i) => i >= clickIntervals.length - 40);
            score += multiplierActive ? 2 : 1; // –ù–∞—á–∏—Å–ª–µ–Ω–∏–µ –≥—Ä—É—à
            updateDisplay();
            if (clickTimes.length > 200) showCaptcha("–°–ª–∏—à–∫–æ–º –±—ã—Å—Ç—Ä–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å –∫–ª–∏–∫–æ–≤!");
            if (checkConsistentIntervals()) showCaptcha("–û–±–Ω–∞—Ä—É–∂–µ–Ω—ã –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ —Ä–æ–≤–Ω—ã–µ –∫–ª–∏–∫–∏!");
        }

        function checkConsistentIntervals() {
            if (clickIntervals.length < 40) return false;
            const avg = clickIntervals.reduce((a, b) => a + b, 0) / clickIntervals.length;
            return clickIntervals.every(i => Math.abs(i - avg) < 10) && (clickTimes[clickTimes.length - 1] - clickTimes[0] >= 20000);
        }

        function buyAutoClicker() {
            if (score >= autoClickerCost) {
                score -= autoClickerCost;
                autoClickers++;
                autoClickerCost = Math.floor(autoClickerCost * 1.15);
                updateDisplay();
            }
        }

        function buyMultiplier() {
            if (score >= multiplierCost && !multiplierActive) {
                score -= multiplierCost;
                multiplierActive = true;
                setTimeout(() => { multiplierActive = false; updateDisplay(); }, 30000);
                updateDisplay();
            }
        }

        function finishGame() {
            const finishCost = 1000000000;
            if (score >= finishCost) { score -= finishCost; updateDisplay(); window.location.href = "https://sites.google.com/view/grushauc/finish1"; }
            else alert("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –≥—Ä—É—à –¥–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∏–≥—Ä—ã!");
        }

        function showCaptcha(message) {
            isCaptchaActive = true;
            modalBody.innerHTML = `
                <div class="auth-container">
                    <h2>–ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Ä–æ–±–æ—Ç–∞</h2>
                    <p>${message}</p>
                    <button class="auth-btn" onclick="showMathCaptcha()">–Ø –Ω–µ —Ä–æ–±–æ—Ç</button>
                </div>`;
            modal.style.display = 'flex';
        }

        function showMathCaptcha() {
            const num1 = Math.floor(Math.random() * 10) + 1, num2 = Math.floor(Math.random() * 10) + 1, correct = num1 + num2;
            modalBody.innerHTML = `
                <div class="auth-container">
                    <h2>–ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Ä–æ–±–æ—Ç–∞</h2>
                    <p>–†–µ—à–∏—Ç–µ –ø—Ä–∏–º–µ—Ä: ${num1} + ${num2} = ?</p>
                    <input type="text" id="captcha-answer" class="auth-input" placeholder="–í–∞—à –æ—Ç–≤–µ—Ç">
                    <button class="auth-btn" onclick="checkCaptcha(${correct})">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å</button>
                </div>`;
        }

        function checkCaptcha(correct) {
            if (parseInt(document.getElementById('captcha-answer').value) === correct) {
                isCaptchaActive = false;
                clickTimes = [];
                clickIntervals = [];
                modal.style.display = 'none';
            } else alert("–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑.");
        }

        function showAuthModal() {
            const encryptedProgress = encryptData();
            modalBody.innerHTML = `
                <span class="close" onclick="closeModal()">√ó</span>
                <div class="auth-container">
                    <h2>–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏ –∑–∞–≥—Ä—É–∑–∫–∞</h2>
                    <p>–í–∞—à –∫–æ–¥ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞:</p>
                    <div class="code-display" id="progressCode">${encryptedProgress}</div>
                    <p class="warning-text">–°–æ—Ö—Ä–∞–Ω–∏—Ç–µ —ç—Ç–æ—Ç –∫–æ–¥ –≤ –∑–∞–º–µ—Ç–∫–∏! –û–Ω —Å–æ–¥–µ—Ä–∂–∏—Ç –≤–∞—à –ø—Ä–æ–≥—Ä–µ—Å—Å –∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è.</p>
                    <button class="auth-btn" onclick="showRegister()">–ù–æ–≤–∞—è –∏–≥—Ä–∞</button>
                    <button class="auth-btn" onclick="showLogin()">–ó–∞–≥—Ä—É–∑–∏—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å</button>
                </div>`;
            modal.style.display = 'flex';
        }

        function showRegister() {
            score = 0; autoClickers = 0; autoClickerCost = 50;
            achievements.forEach(a => a.completed = false);
            updateDisplay();
            const encryptedProgress = encryptData();
            modalBody.innerHTML = `
                <span class="close" onclick="closeModal()">√ó</span>
                <div class="auth-container">
                    <h2>–ù–æ–≤–∞—è –∏–≥—Ä–∞</h2>
                    <p>–ü—Ä–æ–≥—Ä–µ—Å—Å —Å–±—Ä–æ—à–µ–Ω! –ù–æ–≤—ã–π –∫–æ–¥:</p>
                    <div class="code-display" id="progressCode">${encryptedProgress}</div>
                    <p class="warning-text">–°–æ—Ö—Ä–∞–Ω–∏—Ç–µ —ç—Ç–æ—Ç –∫–æ–¥ –≤ –∑–∞–º–µ—Ç–∫–∏! –û–Ω —Å–æ–¥–µ—Ä–∂–∏—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å –∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è.</p>
                    <button class="auth-btn" onclick="closeModal()">–ù–∞—á–∞—Ç—å –∏–≥—Ä–∞—Ç—å</button>
                </div>`;
        }

        function showLogin() {
            modalBody.innerHTML = `
                <span class="close" onclick="closeModal()">√ó</span>
                <div class="auth-container">
                    <h2>–ó–∞–≥—Ä—É–∑–∏—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å</h2>
                    <p>–í–≤–µ–¥–∏—Ç–µ –∫–æ–¥ –∏–∑ –∑–∞–º–µ—Ç–æ–∫:</p>
                    <input type="text" id="login-code" class="auth-input" placeholder="–í—Å—Ç–∞–≤—å—Ç–µ –∫–æ–¥">
                    <button class="auth-btn" onclick="checkLogin()">–ó–∞–≥—Ä—É–∑–∏—Ç—å</button>
                    <p class="warning-text">–ö–æ–¥ –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å –∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è.</p>
                </div>`;
        }

        function copyCode() {
            const codeElement = document.getElementById('progressCode');
            if (codeElement) {
                const code = codeElement.textContent;
                navigator.clipboard.writeText(code).then(() => alert("–ö–æ–¥ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω!")).catch(() => alert("–û—à–∏–±–∫–∞ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è: " + code));
            } else alert("–û—à–∏–±–∫–∞: –∫–æ–¥ –Ω–µ –Ω–∞–π–¥–µ–Ω!");
        }

        function checkLogin() {
            const enteredCode = document.getElementById('login-code').value;
            const decrypted = decryptData(enteredCode);
            if (decrypted && decrypted.length === 4) {
                score = decrypted[0];
                autoClickers = decrypted[1];
                autoClickerCost = decrypted[2];
                const completed = decrypted[3].split('');
                achievements.forEach((a, i) => a.completed = completed[i] === '1');
                updateDisplay();
                modal.style.display = 'none';
                alert("–ü—Ä–æ–≥—Ä–µ—Å—Å –∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –∑–∞–≥—Ä—É–∂–µ–Ω—ã!");
            } else alert("–ù–µ–≤–µ—Ä–Ω—ã–π –∫–æ–¥!");
        }

        function closeModal() { modal.style.display = 'none'; }

        function checkAchievements() {
            achievements.forEach(a => { 
                if (!a.completed && a.condition()) { 
                    a.completed = true; 
                    spawnFallingPears(); 
                } 
            });
            updateAchievementsDisplay();
        }

        function spawnFallingPears() {
            for (let i = 1; i < 15; i++) {
                const pear = document.createElement('div');
                pear.className = 'pear-fall';
                pear.textContent = 'üçê';
                pear.style.left = `${Math.random() * 100}%`;
                document.body.appendChild(pear);
                setTimeout(() => pear.remove(), 2000);
            }
        }

        function updateAchievementsDisplay() {
            achievementList.innerHTML = '';
            achievements.forEach(a => {
                if (a.completed) {
                    const div = document.createElement('div');
                    div.className = 'achievement-item';
                    div.textContent = a.name;
                    achievementList.appendChild(div);
                }
            });
        }

        setInterval(() => { score += autoClickers; updateDisplay(); }, 1000);

        const pearElem = document.getElementById('pear');
        pearElem.addEventListener('click', clickPear);
        updateDisplay();
        updateAchievementsDisplay();
    </script>
</body>
</html>